
# https://github.com/ibraheemdev/matchit
routes:
  - route:
      type: host
      value: localhost # domain.com|domain2.com|domain3.com
    name: http-route-1

    middleware:
      - plugin: RequestHeaderModifier
        payload:
          remove:
            - x-version
          set:
            - name: x-hb-conf
              value: "prefix->${env(HOMEBREW_PREFIX)}"
            - name: x-request-id
              value: "${or(header(host), 'default')}-${or(var(request_id), 'id-1')}"
            - name: x-forwarded-for
              value: "${var(client_ip)}"

      # - plugin: ResponseHeaderModifier
      #   payload:
      #     set:
      #       - name: x-server
      #         value: ${env(SERVER_NAME)}

    paths:
      - path: 
          - /
          - /{*path}
        methods:
          - GET
          - POST
          - OPTIONS
        service:
          name: http-service
      - path: /api/v1/{name}
        middleware:
          - plugin: RequestHeaderModifier
            payload:
              set:
                - name: x-route-name
                  value: "path 2"
        service:
          name: http-service


  - route:
      type: header
      value: my-svc
    name: http-route-2
    paths:
      - path: /{*path}
        service:
          name: http-service-2